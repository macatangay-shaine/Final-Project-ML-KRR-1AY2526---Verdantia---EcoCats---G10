<nav class="navbar">
    <div class="nav-left">
        <a class="nav-brand" href="{{ url_for('mode_select') }}">
            <img class="nav-logo" src="{{ url_for('static', filename='Verdantia Logo.png') }}" alt="Verdantia Logo">
            <span class="nav-brand-text">Verdantia</span>
        </a>
    </div>

    <div class="nav-right">
        <div class="user-section" onclick="toggleDropdown()">
            {% if session.get('profile_avatar') %}
                <img class="nav-avatar"
                     src="{{ url_for('static', filename='uploads/' + session.get('profile_avatar')) }}"
                     alt="User Avatar">
            {% else %}
                <div class="nav-avatar-placeholder">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            {% endif %}
            
            <span class="nav-user">{{ session.get('profile_username') or 'Guest' }}</span>
            
            <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        
        <div class="dropdown-menu" id="userDropdown">
            <a class="dropdown-item" href="{{ url_for('profile') }}">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Profile
            </a>
            <a class="dropdown-item" href="{{ url_for('logout') }}">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M14 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h9v-2H5V5h9V3Zm7.59 8.59L17 7v3h-5v4h5v3l4.59-4.59a1 1 0 0 0 0-1.41Z" fill="currentColor"/>
                </svg>
                Logout
            </a>
        </div>
    </div>
</nav>

<script>
function toggleDropdown() {
    const dropdown = document.getElementById('userDropdown');
    dropdown.classList.toggle('show');
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
    const userSection = document.querySelector('.user-section');
    const dropdown = document.getElementById('userDropdown');
    
    if (!userSection.contains(event.target)) {
        dropdown.classList.remove('show');
    }
});
</script>