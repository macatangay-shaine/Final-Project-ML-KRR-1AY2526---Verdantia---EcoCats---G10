<!DOCTYPE html>
<html>
<head>
    <title>Verdantia - Smart Gardening Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        // Screen controls
        function showScreen(id) {
            const screens = document.querySelectorAll('.screen');
            screens.forEach(s => s.style.display = 'none');
            const el = document.getElementById(id);
            if (el) el.style.display = 'block';

            // Hide profile bar and navbar on landing; show on other screens
            const profileBar = document.querySelector('.profile-bar');
            const navbar = document.querySelector('.navbar');
            if (profileBar) {
                profileBar.style.display = (id === 'screen-1') ? 'none' : 'flex';
            }
            if (navbar) {
                navbar.style.display = (id === 'screen-1') ? 'none' : 'flex';
            }
        }

        function startLandingSequence() {
            // Show first landing slide then switch to second slide after 3s
            const slide1 = document.querySelector('.landing-slide-1');
            const slide2 = document.querySelector('.landing-slide-2');
            if (slide1) {
                slide1.style.display = 'block';
                slide1.classList.add('fade-in');
            }

            // After ~3s, fade slide1 out and fade slide2 in
            setTimeout(() => {
                if (!slide1 || !slide2) return;
                slide1.classList.remove('fade-in');
                slide1.classList.add('fade-out');
                // wait for fade-out then swap (shortened for snappier UX)
                setTimeout(() => {
                    slide1.style.display = 'none';
                    slide1.classList.remove('fade-out');
                    slide2.style.display = 'block';
                    slide2.classList.add('fade-in');
                }, 550);
            }, 3000);
        }

        // Existing helpers
        function toggleMode() {
            const selectEl = document.getElementById('mode');
            const plantField = document.getElementById('plant-field');
            if (!selectEl || !plantField) return;
            const mode = selectEl.value;
            plantField.style.display = (mode === 'diagnose') ? 'block' : 'none';
        }

        function selectModeAndContinue(mode) {
            const selectEl = document.getElementById('mode');
            selectEl.value = mode;
            toggleMode();
            showScreen('screen-3');
        }

        function toggleTooltip(id) {
            const tooltip = document.getElementById(id);
            if (!tooltip) return;
            tooltip.style.display = tooltip.style.display === 'block' ? 'none' : 'block';
        }

        function setDefault(field, value) {
            const el = document.getElementsByName(field)[0];
            if (el) el.value = value;
        }

        function setAllDefaults() {
            setDefault('n', 50);
            setDefault('p', 50);
            setDefault('k', 50);
            setDefault('ph', 6.5);
            setDefault('temperature', 25);
            setDefault('humidity', 70);
            setDefault('rainfall', 150);
        }

        function updateSoilImage() {
            const soilTypeEl = document.getElementById('soil_type');
            const soilPreview = document.getElementById('soil-preview');
            if (!soilTypeEl || !soilPreview) return;
            const soilType = soilTypeEl.value;
            const soilImages = {
                'Clay': 'https://images.unsplash.com/photo-1628600185380-58f5b1e663ae?w=300&h=200&fit=crop',
                'Loam': 'https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?w=300&h=200&fit=crop',
                'Sandy': 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=300&h=200&fit=crop'
            };
            const src = soilImages[soilType];
            if (src) {
                soilPreview.src = src;
                soilPreview.style.display = 'block';
            } else {
                soilPreview.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const hasResultAttr = (document.body.dataset?.hasResult || document.body.getAttribute('data-has-result') || 'False').toString().toLowerCase();
            const hasErrorAttr = (document.body.dataset?.hasError || document.body.getAttribute('data-has-error') || 'False').toString().toLowerCase();
            const hasResult = hasResultAttr === 'true';
            const hasError = hasErrorAttr === 'true';

            if (hasResult || hasError) {
                showScreen('screen-3');
            } else {
                showScreen('screen-1');
                startLandingSequence();
            }

            toggleMode();
            updateSoilImage();

            // Local Profile: initialize from localStorage or server-provided session fallback
            initLocalProfile({
                username: "{{ (profile_username or '')|e }}",
                avatar: "{{ (profile_avatar or '')|e }}"
            });
            // Ensure hidden inputs are synced before form submit
            const form = document.querySelector('form');
            if (form) {
                form.addEventListener('submit', syncHiddenProfileInputs);
            }
            const saveBtn = document.getElementById('save-profile-btn');
            if (saveBtn) saveBtn.addEventListener('click', saveProfileToLocal);
            const avatarInput = document.getElementById('avatar-input');
            if (avatarInput) avatarInput.addEventListener('change', handleAvatarFileChange);
        });

        // --- Local Profile (username + avatar) ---
        const LS_USERNAME_KEY = 'sg_profile_username';
        const LS_AVATAR_KEY = 'sg_profile_avatar';

        function initLocalProfile(serverFallback) {
            try {
                let username = localStorage.getItem(LS_USERNAME_KEY);
                let avatar = localStorage.getItem(LS_AVATAR_KEY);

                if (!username && serverFallback && serverFallback.username) {
                    username = serverFallback.username;
                }
                if (!avatar && serverFallback && serverFallback.avatar) {
                    avatar = serverFallback.avatar;
                }

                // Defaults
                if (!username) username = 'Gardener';

                // Update UI
                const unameInput = document.getElementById('username-input');
                const unameDisplay = document.getElementById('username-display');
                const avatarImg = document.getElementById('profile-avatar');
                if (unameInput) unameInput.value = username;
                if (unameDisplay) unameDisplay.textContent = username;
                if (avatarImg) {
                    if (avatar) {
                        avatarImg.src = avatar;
                    } else {
                        avatarImg.src = 'https://via.placeholder.com/96?text=üå±';
                    }
                }

                // Sync hidden inputs for session fallback
                syncHiddenProfileInputs();
            } catch (e) {
                // If localStorage is unavailable, still attempt to use serverFallback
                const unameInput = document.getElementById('username-input');
                const unameDisplay = document.getElementById('username-display');
                const avatarImg = document.getElementById('profile-avatar');
                const username = (serverFallback && serverFallback.username) || 'Gardener';
                const avatar = (serverFallback && serverFallback.avatar) || '';
                if (unameInput) unameInput.value = username;
                if (unameDisplay) unameDisplay.textContent = username;
                if (avatarImg) avatarImg.src = avatar || 'https://via.placeholder.com/96?text=üå±';
                syncHiddenProfileInputs();
            }
        }

        function handleAvatarFileChange(event) {
            const file = event.target.files && event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const dataUrl = e.target.result;
                const avatarImg = document.getElementById('profile-avatar');
                if (avatarImg) avatarImg.src = dataUrl;
                try { localStorage.setItem(LS_AVATAR_KEY, dataUrl); } catch (_) {}
                syncHiddenProfileInputs();
            };
            reader.readAsDataURL(file);
        }

        function saveProfileToLocal() {
            const unameInput = document.getElementById('username-input');
            if (!unameInput) return;
            const username = (unameInput.value || 'Gardener').trim();
            const unameDisplay = document.getElementById('username-display');
            if (unameDisplay) unameDisplay.textContent = username;
            try { localStorage.setItem(LS_USERNAME_KEY, username); } catch (_) {}
            syncHiddenProfileInputs();
        }

        function syncHiddenProfileInputs() {
            const hiddenU = document.getElementById('profile_username_hidden');
            const hiddenA = document.getElementById('profile_avatar_hidden');
            const unameInput = document.getElementById('username-input');
            const avatarImg = document.getElementById('profile-avatar');
            if (hiddenU && unameInput) hiddenU.value = (unameInput.value || 'Gardener').trim();
            if (hiddenA && avatarImg) hiddenA.value = avatarImg.src || '';
        }
    </script>
</head>
<body data-has-result="{{ (result is not none) }}" data-has-error="{{ (error is not none) }}">

{% include "partials/navbar.html" %}

<main class="page-content">
<div class="app">
    <!-- Profile Bar: Local-only personalization (no auth) -->
    <div class="profile-bar">
        <div class="avatar-wrap">
            <img id="profile-avatar" alt="Avatar" />
        </div>
        <div class="profile-controls">
            <input type="text" id="username-input" class="profile-input" placeholder="Set your username" />
            <input type="file" id="avatar-input" class="profile-input" accept="image/*" />
            <button type="button" id="save-profile-btn" class="profile-save">Save Profile</button>
        </div>
        <div class="profile-summary">Hello, <span id="username-display">Gardener</span> üåø</div>
    </div>
    <!-- SCREEN 1: Landing -->
    <section id="screen-1" class="screen hero-landing">
        <div class="hero-overlay">
            <!-- Slide 1: initial headline -->
            <div class="landing-slide landing-slide-1" style="display:none;">
                <div class="hero-text">
                    <h1>Welcome to Verdantia</h1>
                    <p>Your Smart Gardening Assistant</p>   
                </div>
            </div>

            <!-- Slide 2: follow-up with Proceed button -->
            <div class="landing-slide landing-slide-2" style="display:none;">
                <div class="hero-text">     
                    <h1>Verdantia is a Smart Gardening Assistant</h1>
                    <p>Using machine learning and smart plant knowledge to help you grow healthier crops.</p>
                    <button class="cta getsarted-btn" onclick="showScreen('screen-2')">Get Started</button>
                </div>
            </div>
        </div>
    </section>

    <!-- SCREEN 2: Mode Selection -->
    <section id="screen-2" class="screen mode-select" style="display:none;">
        <div class="mode-inner two-column">
            <div class="mode-left">
                <div class="logo-and-title">
                    <img src="{{ url_for('static', filename='logo.png') }}" alt="Verdantia" class="mini-logo" onerror="this.style.display='none'">
                    <h2>Choose a mode</h2>
                </div>

                <button class="mode-button" onclick="selectModeAndContinue('recommend')">
                    <div class="btn-icon">üçÉ</div>
                    <div class="btn-text">
                        <div class="btn-title">Plant Recommendation</div>
                        <div class="btn-sub">Find the best crop for your soil & climate</div>
                    </div>
                </button>

                <button class="mode-button secondary" onclick="selectModeAndContinue('diagnose')">
                    <div class="btn-icon">üíö</div>
                    <div class="btn-text">
                        <div class="btn-title">Plant Health Advisor</div>
                        <div class="btn-sub">Diagnose issues and get care tips</div>
                    </div>
                </button>
            </div>

            <div class="mode-right">
                <div class="info-card">
                    <div class="info-item">
                        <div class="info-icon">üíß</div>
                        <div class="info-body">
                            <div class="info-title">Water analysis</div>
                            <div class="info-sub">Monitor and optimize your watering schedule.</div>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-icon">‚òÄÔ∏è</div>
                        <div class="info-body">
                            <div class="info-title">Sunlight analysis</div>
                            <div class="info-sub">Find the perfect spot for each plant</div>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-icon">üå¨Ô∏è</div>
                        <div class="info-body">
                            <div class="info-title">Soil analysis</div>
                            <div class="info-sub">Weather-based care recommendations</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SCREEN 3: Form + Results (two-column) -->
    <section id="screen-3" class="screen form-screen" style="display:none;">
        <div class="form-header">
            <button class="back-btn" onclick="showScreen('screen-2')">‚Äπ</button>
            <div class="form-title">Plant Recommendation</div>
            <div class="form-actions">
                <button class="icon-btn" title="Profile">üë§</button>
                <button class="icon-btn" title="Close" onclick="showScreen('screen-1')">‚úï</button>
            </div>
        </div>

        <div class="form-results-grid">
            <div class="form-panel">
                <form method="POST">
                    <!-- Hidden inputs to provide session fallback during active sessions -->
                    <input type="hidden" name="profile_username" id="profile_username_hidden" />
                    <input type="hidden" name="profile_avatar" id="profile_avatar_hidden" />

                    <div class="compact-mode-selector">
                        <label><strong>Mode</strong></label>
                        <select name="mode" id="mode" onchange="toggleMode(); updateFormTitle();">
                            <option value="recommend">Get Plant Recommendation</option>
                            <option value="diagnose">Diagnose My Plant Health</option>
                        </select>
                    </div>

                    <div id="plant-field" style="display: none;">
                        <label>Current Plant (for diagnosis)</label>
                        <input type="text" name="current_plant" placeholder="e.g., tomato, lettuce, rice">
                    </div>

                    <h3>Environmental Conditions</h3>

                    <!-- (keep input groups unchanged) -->
                    <div class="input-group">
                        <label>Nitrogen (N) 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-n')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-n" class="tooltip">
                            <strong>Nitrogen (N):</strong> Essential for leaf growth and green color. Typical range: 0-140 kg/ha.<br>
                            <strong>üí∞ No test kit?</strong> Visual clues:<br>
                            ‚Ä¢ Dark green leaves = High (60-90)<br>
                            ‚Ä¢ Yellow/pale leaves = Low (20-40)<br>
                            ‚Ä¢ Normal green = Medium (40-60)<br>
                            <button type="button" class="default-btn" onclick="setDefault('n', 50)">Use Typical (50)</button>
                        </div>
                        <input type="number" step="any" name="n" required placeholder="e.g., 90">
                    </div>

                    <div class="input-group">
                        <label>Phosphorus (P) 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-p')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-p" class="tooltip">
                            <strong>Phosphorus (P):</strong> Vital for root development, flowering, and fruiting. Typical range: 5-145 kg/ha.<br>
                            <strong>üí∞ No test kit?</strong> Observe plants:<br>
                            ‚Ä¢ Purple/dark leaves = Low (20-40)<br>
                            ‚Ä¢ Slow flowering = Low (20-40)<br>
                            ‚Ä¢ Normal growth = Medium (40-60)<br>
                            <button type="button" class="default-btn" onclick="setDefault('p', 50)">Use Typical (50)</button>
                        </div>
                        <input type="number" step="any" name="p" required placeholder="e.g., 42">
                    </div>

                    <div class="input-group">
                        <label>Potassium (K) 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-k')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-k" class="tooltip">
                            <strong>Potassium (K):</strong> Strengthens plants, improves disease resistance. Typical range: 5-205 kg/ha.<br>
                            <strong>üí∞ No test kit?</strong> Signs:<br>
                            ‚Ä¢ Brown leaf edges = Low (20-40)<br>
                            ‚Ä¢ Weak stems = Low (20-40)<br>
                            ‚Ä¢ Healthy stems = Medium (40-60)<br>
                            <button type="button" class="default-btn" onclick="setDefault('k', 50)">Use Typical (50)</button>
                        </div>
                        <input type="number" step="any" name="k" required placeholder="e.g., 43">
                    </div>

                    <div class="input-group">
                        <label>pH Level 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-ph')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-ph" class="tooltip">
                            <strong>pH Level:</strong> Measures soil acidity/alkalinity. Scale: 0-14. Neutral = 7. Most plants prefer 6-7.5.<br>
                            <strong>üí∞ DIY Test:</strong><br>
                            ‚Ä¢ Mix soil + vinegar ‚Üí Fizzes = Alkaline (7.5+)<br>
                            ‚Ä¢ Mix soil + baking soda water ‚Üí Fizzes = Acidic (5.5-)<br>
                            ‚Ä¢ No fizz = Neutral (6-7)<br>
                            <strong>Or use red cabbage juice as pH indicator!</strong><br>
                            <button type="button" class="default-btn" onclick="setDefault('ph', 6.5)">Use Neutral (6.5)</button>
                        </div>
                        <input type="number" step="any" name="ph" required placeholder="e.g., 6.5" min="0" max="14">
                    </div>

                    <div class="input-group">
                        <label>Temperature (¬∞C) 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-temp')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-temp" class="tooltip">
                            <strong>Temperature:</strong> Average daily temperature in Celsius. Typical range: 8-45¬∞C.<br>
                            <strong>üí∞ Free:</strong> Check weather apps, Google, or weather.com for your location.<br>
                            <button type="button" class="default-btn" onclick="setDefault('temperature', 25)">Use Tropical (25¬∞C)</button>
                        </div>
                        <input type="number" step="any" name="temperature" required placeholder="e.g., 25">
                    </div>

                    <div class="input-group">
                        <label>Humidity (%) 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-humidity')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-humidity" class="tooltip">
                            <strong>Humidity:</strong> Percentage of moisture in the air. Range: 14-100%.<br>
                            <strong>üí∞ Free:</strong> Check weather apps or websites.<br>
                            ‚Ä¢ Coastal/rainy areas: 70-90%<br>
                            ‚Ä¢ Dry areas: 30-50%<br>
                            <button type="button" class="default-btn" onclick="setDefault('humidity', 70)">Use Typical (70%)</button>
                        </div>
                        <input type="number" step="any" name="humidity" required placeholder="e.g., 80" min="0" max="100">
                    </div>

                    <div class="input-group">
                        <label>Rainfall (mm) 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-rainfall')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-rainfall" class="tooltip">
                            <strong>Rainfall:</strong> Average monthly or annual rainfall in millimeters.<br>
                            <strong>üí∞ Free:</strong> Google "average rainfall [your city]" or check weather websites.<br>
                            ‚Ä¢ Heavy rain: 200+ mm/month<br>
                            ‚Ä¢ Moderate: 100-200 mm/month<br>
                            ‚Ä¢ Light: 50-100 mm/month<br>
                            <button type="button" class="default-btn" onclick="setDefault('rainfall', 150)">Use Moderate (150mm)</button>
                        </div>
                        <input type="number" step="any" name="rainfall" required placeholder="e.g., 200">
                    </div>

                    <div class="input-group">
                        <label>Soil Type 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-soil')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-soil" class="tooltip">
                            <strong>Soil Types:</strong><br>
                            ‚Ä¢ <strong>Clay:</strong> Heavy, sticky when wet, holds water well<br>
                            ‚Ä¢ <strong>Loam:</strong> Balanced mix, ideal for most plants<br>
                            ‚Ä¢ <strong>Sandy:</strong> Light, drains quickly, feels gritty
                        </div>
                        <select name="soil_type" id="soil_type" onchange="updateSoilImage()">
                            <option value="Clay">Clay (Heavy, water-retaining)</option>
                            <option value="Loam">Loam (Balanced, ideal)</option>
                            <option value="Sandy">Sandy (Light, fast-draining)</option>
                        </select>
                        <img id="soil-preview" class="soil-preview" alt="Soil preview">
                    </div>

                    <div class="input-group">
                        <label>Climate Type 
                            <button type="button" class="info-btn" onclick="toggleTooltip('tooltip-climate')">
                                <img src="{{ url_for('static', filename='info-icon.svg') }}" alt="info" class="info-icon">
                            </button>
                        </label>
                        <div id="tooltip-climate" class="tooltip">
                            <strong>Climate Types:</strong><br>
                            ‚Ä¢ <strong>Tropical Wet:</strong> High rainfall year-round<br>
                            ‚Ä¢ <strong>Tropical Moist:</strong> Wet/dry seasons<br>
                            ‚Ä¢ <strong>Tropical Dry:</strong> Long dry periods<br>
                            ‚Ä¢ <strong>Urban Heat Zone:</strong> City areas with heat buildup
                        </div>
                        <select name="climate">
                            <option value="Tropical Wet">Tropical Wet (Rainy year-round)</option>
                            <option value="Tropical Moist">Tropical Moist (Seasonal rain)</option>
                            <option value="Tropical Dry">Tropical Dry (Long dry spells)</option>
                            <option value="Urban Heat Zone">Urban Heat Zone (City heat)</option>
                        </select>
                    </div>

                    <div class="default-all-section">
                        <p><strong>üí° Don't have testing equipment?</strong></p>
                        <button type="button" class="default-all-btn" onclick="setAllDefaults()">üìù Fill with Typical Values</button>
                        <p class="hint-text">Use typical values for tropical gardening, then adjust based on your observations</p>
                    </div>

                    <button type="submit" class="analyze-btn">Analyze</button>
                </form>
            </div>

            <div class="results-panel">
                <!-- Errors and Results moved into right column -->
                {% if error %}
                <div class="error">
                    <h2>‚ö†Ô∏è Error</h2>
                    <p>{{ error }}</p>
                </div>
                {% endif %}

                {% if result %}
                <div class="result card">
                    <h2>üìä Results</h2>
                    {% if result.mode == 'recommend' %}
                        <div class="recommendation">
                            <h3>üåæ Recommended Crop</h3>
                            <div class="crop-display">
                                <div class="crop-icon">
                                    {% if result.crop in ['rice', 'wheat', 'maize'] %}
                                        üåæ
                                    {% elif result.crop in ['apple', 'banana', 'mango', 'orange', 'papaya', 'watermelon', 'grapes', 'pomegranate'] %}
                                        üçé
                                    {% elif result.crop in ['tomato', 'potato', 'carrot', 'lettuce', 'spinach'] %}
                                        ü•¨
                                    {% elif result.crop in ['coffee', 'cotton'] %}
                                        ‚òï
                                    {% else %}
                                        üå±
                                    {% endif %}
                                </div>
                                <p class="crop-name">{{ result.crop }}</p>
                            </div>
                            <p><strong>Message:</strong> {{ result.message }}</p>
                        </div>
                    {% elif result.mode == 'diagnose' %}
                        <div class="diagnosis">
                            <h3>üîç Plant Health Diagnosis: {{ result.plant }}</h3>
                            <div class="condition-badge condition-{{ result.condition.lower().replace(' ', '-') }}">
                                {% if result.condition == 'Healthy' %}
                                    ‚úÖ {{ result.condition }}
                                {% elif result.condition in ['Overwatered', 'Flood / Waterlogging Risk'] %}
                                    üíß {{ result.condition }}
                                {% elif result.condition == 'Underwatered' %}
                                    üèúÔ∏è {{ result.condition }}
                                {% elif result.condition == 'Pest Risk' %}
                                    üêõ {{ result.condition }}
                                {% elif result.condition == 'Nutrient Deficiency' %}
                                    üå± {{ result.condition }}
                                {% else %}
                                    ‚ö†Ô∏è {{ result.condition }}
                                {% endif %}
                            </div>
                            <p><strong>Reason:</strong> {{ result.reason }}</p>
                            <p><strong>üí° Advice:</strong> {{ result.advice }}</p>
                        </div>
                    {% endif %}

                    <details class="details">
                        <summary>View Environmental Conditions</summary>
                        <ul>
                            <li>Nitrogen: {{ result.inputs.n }}</li>
                            <li>Phosphorus: {{ result.inputs.p }}</li>
                            <li>Potassium: {{ result.inputs.k }}</li>
                            <li>Temperature: {{ result.inputs.temperature }}¬∞C</li>
                            <li>Humidity: {{ result.inputs.humidity }}%</li>
                            <li>Rainfall: {{ result.inputs.rainfall }}mm</li>
                            <li>Soil Type: {{ result.inputs.soil_type }}</li>
                            <li>Climate: {{ result.inputs.climate }}</li>
                        </ul>
                    </details>
                </div>
                {% endif %}
            </div>
        </div>

        <script>
            function updateFormTitle(){
                var sel = document.getElementById('mode');
                var title = document.querySelector('.form-title');
                if(!sel || !title) return;
                title.textContent = sel.value === 'diagnose' ? 'Plant Health Advisor' : 'Plant Recommendation';
            }
            document.addEventListener('DOMContentLoaded', updateFormTitle);
        </script>
    </section>

    </section>
</div>
</main>

</body>
</html>
